---
type Props = {
  href?: string;
  fallback?: string;
}

const { href, fallback = "/" } = Astro.props;
---
 
<button 
  class="back-button relative group w-fit flex pl-7 pr-3 py-1.5 flex-nowrap rounded border border-black/15 dark:border-white/20 hover:bg-black/5 dark:hover:bg-white/5 hover:text-black dark:hover:text-white transition-colors duration-300 ease-in-out cursor-pointer"
  data-href={href}
  data-fallback={fallback}
  onclick="handleBackClick(this)"
>
  <svg 
    xmlns="http://www.w3.org/2000/svg" 
    viewBox="0 0 24 24"
    class="absolute top-1/2 left-2 -translate-y-1/2 size-4 stroke-2 fill-none stroke-current">
    <line x1="5" y1="12" x2="19" y2="12" class="translate-x-2 group-hover:translate-x-0 scale-x-0 group-hover:scale-x-100 transition-transform duration-300 ease-in-out" />
    <polyline points="12 5 5 12 12 19" class="translate-x-1 group-hover:translate-x-0 transition-transform duration-300 ease-in-out" />
  </svg>
  <div class="text-sm">
    <slot/>
  </div>
</button>

<script is:inline>
  function handleBackClick(button) {
    console.log('Back button clicked'); // 調試用
    
    // 嘗試回到上一頁
    if (document.referrer && document.referrer !== window.location.href) {
      console.log('Going back to:', document.referrer);
      window.history.back();
    } else {
      // 如果沒有 referrer，使用 fallback
      const fallback = button.getAttribute('data-fallback') || '/';
      const href = button.getAttribute('data-href') || fallback;
      console.log('No referrer, going to fallback:', fallback);
      window.location.href = href;
    }
  }
</script>
